\documentclass{article}
\usepackage[a4paper, total={6in, 8in}]{geometry}
\usepackage[utf8]{inputenc}
\usepackage[affil-it]{authblk}
\usepackage[english]{babel}
\usepackage{polski}

% packages for title page
\usepackage{siunitx}
\usepackage[export]{adjustbox}
\usepackage{graphicx, wrapfig}
\usepackage{tabularx}
\usepackage{amsmath}
\usepackage{fancyhdr}

\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{mathrsfs}

\usepackage{xcolor}
\usepackage{subfigure}
\usepackage[super]{nth}
\usepackage{indentfirst}
\usepackage{algorithm,algorithmic}
\usepackage{enumerate}
\usepackage[toc,page]{appendix}

\usepackage{amsthm}
\usepackage{pdfcomment}
\usepackage{textgreek}

\usepackage[siunitx,americaninductors]{circuitikz}
\usepackage{schemabloc}
\usetikzlibrary{circuits}
\usepackage{tikz, pgfplots}
\usetikzlibrary{shapes,arrows}
\usepackage{verbatim}

\begin{document}


\input{title_pages/titlepage_PL.tex}
\clearpage\thispagestyle{empty}
\tableofcontents
\clearpage\thispagestyle{empty}

\section*{Notation}

\begin{table}[h!]
    \vspace{-1.em} 
    \fontsize{10}{10}
    \selectfont 
    \renewcommand{\arraystretch}{1.5}
    \begin{center}
    \begin{tabular}{ l l }  
    \hline
    $A_\text{Cu}$ & cross-sectional area of copper in a wire \\  
    $B_\text{c20}$ & intercepts of critical surface along magnetic field axis \\  
    $C_\text{p, equiv}$ & equivalent specific heat capacity of a wire \\  
    $C_\text{p, Cu}$ & specific heat capacity of copper \\   
    $C_\text{p, NbTi}$ & specific heat capacity of NbTi \\  
    $d_\text{strand}$ & real diameter of a wire \\  
    $d_\text{strand, red}$ & reduced diameter of a wire \\   
    $f_\text{Cu}$ &  copper volumetric ratio in a wire\\        
    $f_\text{NbTi}$ &  NbTi volumetric ratio in a wire\\   
    $T_\text{c}$ & critical temperature \\
    $T_\text{c0}$ & intercepts of critical surface along temperature axis \\
    $RRR$ & residual resistivity ratio \\
    \hline
     \end{tabular} 
    \end{center}  
 \end{table}
\newpage

% official introduction of the Master thesis
\pagestyle{fancy}
\section{Introduction}

\subsection{About CERN}

\subsection{Superconductors}

\begin{figure}[ht!]
\centering
\includegraphics[width=0.49\linewidth]{figures/introduction/critical_surface_scheme.png}
\caption{Schematic of the critical surface of $\text{Nb}_\text{3}\text{Sn}$ and Nb-Ti \cite{evans_marvel_of_technology}}
\label{fig:scheme_critical_surface}
\end{figure}

\subsection{Quench Problem}

    \subsubsection{Copper Resistivity}
    Copper residual resistivity ratio according to NIST: 
    \begin{equation}
    RRR = \frac{\rho(T=273~\text{K}, B=0~\text{T})}{\rho(T=4~\text{K}, B=0~\text{T})}
    \end{equation}
    
    \subsubsection{Critical Parameters for Superconductivity}
    Critical current:
    \begin{equation}
        I_\text{c}(T) = I \frac{T-T_\text{cs}}{T_\text{c}-T_\text{cs}}
    \end{equation}
    \\
    Critical temperature:
    \begin{equation}
        T_\text{c}(B) = 9.2 \cdot [1- \frac{B}{14.5}]^{0.59}~\text{for}~B~<~10~\text{T}
    \end{equation}
    \\
    Critical magnetic field: 
    \begin{equation}
        B_\text{c2}(T) = B_\text{c2}(T=0) \cdot [1-(\frac{T}{T_\text{c}(B=0)})^{n}],
    \end{equation}
    where
    $B_\text{c2}(T=0)=14.5~\text{T}$, $T_\text{c}(B=0)=9.2~\text{K}$, $n=1.7$.

    \subsubsection{Current Flow in Copper Matrix}
    
    Current sharing temperature: 
    \begin{equation}
        T_\text{cs} = T_\text{c} (1 - \frac{I}{\text{c}_1 + \text{c}_2 B }),
    \end{equation}
    where $\text{c}_1=3449~\text{A}$ and $\text{c}_2=-257~\text{AT}^{-1}$
    \\
    Current in copper matrix: 
    \begin{equation}
        \left\{ \begin{array}{lll}
        I_\text{Cu} = 0 & \text{for}~T < T_\text{cs} \\ \\
        I_\text{Cu} = I - I_\text{c} & \text{for}~T_\text{cs} \leq T<T_\text{c}  \\ \\
        I_\text{Cu} = I & \text{for}~T_\text{cs} \leq T
        \end{array} \right.
    \end{equation}
    \\
    Joule heating: 
    \begin{equation}
        \left\{ \begin{array}{lll}
        q_\text{Joule} = 0 & \text{for}~T < T_\text{cs} \\ \\
        q_\text{Joule} = \rho_\text{Cu}(T, B) \frac{(I-I_\text{c})^2}{{\text{a}_\text{Cu}}^2}& \text{for}~T_\text{cs} \leq T<T_\text{c}  \\ \\
        q_\text{Joule} = \rho_\text{Cu}(T, B) \frac{I^2}{{\text{a}_\text{Cu}}^2} & \text{for}~T_\text{cs} \leq T
        \end{array} \right.
    \end{equation}

    \begin{figure}[ht!]
    \centering
    \includegraphics[width=0.49\linewidth]{figures/skew_quad_bcs/magnetic_field_mapping/Heat_Generation_Curve_B_3.png}
    \caption{Heat Generation Curve as a function of temperature for B=3 T}
    \label{fig:H_gen_curve}
    \end{figure}
    
\subsection{Accelerator Magnets}
What type of magnets can we find? \\
How are they protected? \\
Passive and active protections \\ 
Self-protectability

\subsection{Analyses in Superconductors}

\subsection{Numerical Analyses}

Heat conduction equation: 
\begin{equation}
    \frac{\partial}{\partial x}[k(B) \frac{\partial T}{\partial x}] + q_v = \rho c_p \frac{\partial T}{\partial t}
\end{equation}

\subsection{Thermal Numerical Analyses}

To write in introduction: 
Wilson: \\
- point disturbances (page 74) \\
- minimum propagating zone (MPZ) (same page - up to 80 something...)

% AIM THESIS
\clearpage \thispagestyle{empty}
\section{Aim of Thesis}

\subsection{Research Aim and Objectives}
\input{sections/aim_thesis/research_aims_and_objectives.tex}

\subsection{Structure of the Thesis}
\input{sections/aim_thesis/structure_thesis.tex}

% 1D QUENCH PROPAGATION MODELLING 
\clearpage
\section{1D Quench Propagation Modelling}
\label{section: 1d_quench_propagation_modelling}
\input{sections/1D_quench_modelling/introduction.tex}

\subsection{Geometry}
\label{subsection: 1d_quench_propagation_geometry}
\input{sections/1D_quench_modelling/geometry.tex}

\subsection{1D Analysis without Insulation}
\label{subsection: 1D_quench_propagation_no_insulation}
\input{sections/1D_quench_modelling/analysis_no_insulation.tex}

\subsection{1D Analysis with Insulation}
\label{subsection: 1D_quench_propagation_with_insulation}
\input{sections/1D_quench_modelling/analysis_with_insulation.tex}

\subsection{Conclusion}
\label{subsection: 1D_quench_propagation_conclusions}
\input{sections/1D_quench_modelling/conclusions.tex}
 
% QUENCH VELOCITY MODELLING
\clearpage
\section{Quench Velocity Modelling}
\label{section:quench_velocity_modelling}

\subsection{Concept}
\label{subsection:quench_velocity_concept}
\input{sections/q_vel_modelling/quench_velocity_concept.tex}

\subsection{Problematics}
\label{subsection:quench_velocity_problematics}
\input{sections/q_vel_modelling/quench_velocity_problematics.tex}

\subsection{Co-simulation Modelling}
\label{subsection:quench_velocity_cosimulation}
\input{sections/q_vel_modelling/q_vel_cosimulation.tex}

% QUENCH VELOCITY MODELLING BENCHMARKING
\clearpage
\section{Quench Velocity Modelling Benchmarking}
\label{section:quench_velocity_benchmarking}
\input{sections/q_vel_modelling_benchmarking/quench_velocity_benchmarking.tex}

\subsection{Analysis without Insulation}
\label{subsection:quench_velocity_benchmarking_no_insulation}

\subsubsection{Heat Balance - Based Analysis}
\input{sections/q_vel_modelling_benchmarking/no_insulation_heat_balance.tex}

\subsubsection{Quench Velocity - Based Analysis}
\input{sections/q_vel_modelling_benchmarking/no_insulation_quench_velocity.tex}

\subsection{Analysis with Insulation}
\label{subsection:quench_velocity_benchmarking_with_insulation}
\input{sections/q_vel_modelling_benchmarking/quench_velocity_benchmarking_with_insulation.tex}

% ALGORITHMS AND PYTHON IMPLEMENTATION
\clearpage
\section{Algorithms}
\label{section:algorithms}
\input{sections/algorithms/introduction.tex}

\subsection{Multidimensional Mapping Algorithm}
\label{subsection:multidimensional_mapping_algorithm}
\input{sections/algorithms/multidimensional_mapping.tex}

\subsection{Node Searching Algorithm}
\label{subsection:node_searching_algorithm}
\input{sections/algorithms/node_search_alg.tex}

\subsection{Quench Detection Algorithm}
\label{subsection:quench_detection_algorithm}
\input{sections/algorithms/q_det_alg.tex}

% PYTHON IMPLEMENTATION
\clearpage
\section{Analysis Implementation in Python}
\label{section:python_implementation}
\input{sections/implementation_python/python_framework.tex}

% SKEW QUADRUPOLE ANALYSIS - QUENCH DETECTION
\clearpage
\section{Skew Quadrupole Quench Detection Analysis}
\label{section:skew_quadrupole_quench_detection_analysis}

This chapter describes the thermal quench analysis of a skew quadrupole developed by LASA laboratories of INFN-Milano. The skew quadrupole belongs to the group of high-order corrector magnets designed for the upgrade of High-Luminosity LHC. Their design assumes using no quench protection devices such as quench heaters or CLIQ except for crowbars \footnote{Describe what crowbars are...}. Therefore, when any of these magnet quenches, the discharge of energy stored in their magnetic field occurs merely by their own rise in resistivity. i.e. they are self-protected.

Quench velocity approach presented in chapter \ref{section:quench_velocity_modelling} is used to analyze the magnet as a 3-dimensional thermal domain. It is verified by comparing the available measurements of a quenched skew quadrupole with the simulation results conducted in ANSYS. One has to remember that the skew quadrupole is the only high-order corrector which has quench protection system installed, i.e. it is not self-protected. However, it has been used for illustration purposes because of its available quench measurements when quench heaters were not used. 

\subsection{Geometry}
\input{sections/skew_quad_q_det/geometry.tex}

\subsection{Assumptions for Geometry and Material Properties}
\input{sections/skew_quad_q_det/geometry_material_assumptions.tex}

\subsection{Quench Measurements}
\input{sections/skew_quad_q_det/quench_measurements.tex}

\subsection{Initial Conditions...}
\input{sections/skew_quad_q_det/initial_conditions.tex}

\subsection{Quench Velocity Mapping}
\input{sections/skew_quad_q_det/quench_velocity_mapping.tex}

% APPENDICES
\clearpage
\begin{appendices}

\section{Material Properties}
\label{appendix_material_properties_description}

The material properties are based on an update of ROXIE database prepared at CERN \cite{material_properties_roxie}. Except for Nb-Ti specific heat capacity, NIST standards for cryogenic materials are used to describe them. Nb-Ti is defined by CUDI which is Arjan Verweij's software for Rutherford cable modelling~\cite{cudi_manual}.  

\subsection{Copper}
\label{appendix:cu_material_properties}
\input{sections/appendices/material_properties/copper.tex}

% \subsection{Niobium Titanium}
% \label{appendix:nbti_material_properties}
% \input{sections/appendices/material_properties/niobium_titanium.tex}

% \subsection{G10 Material Properties}
% \label{appendix:g10_material_properties}
% \input{sections/appendices/material_properties/g10.tex}

\section{Compilation of ANSYS with Python Environment}
\label{appendix:python_ansys_compilation}
\input{sections/appendices/compilation_ansys_python/compilation_ansys_python.tex}

% \section{Mapping Algorithm Python Script}
% \section{Quench Velocity Algorithm Python Script}
% \section{Nodes Search Algorithm Python Script}

\end{appendices}

\clearpage
\bibliographystyle{IEEEtran}
\bibliography{IEEEabrv,./bib/article}

\end{document}
